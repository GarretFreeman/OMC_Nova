<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OMC ‚Äî Intranet</title>
  <style>
    :root{
      --bg:#0f172a;
      --card:#111827;
      --muted:#1f2937;
      --text:#e5e7eb;
      --accent:#38bdf8;
      --accent-2:#22d3ee;
      --ok:#22c55e;
      --warn:#f59e0b;
      --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(135deg,var(--bg),#03121b 60%);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;align-items:center;gap:16px;margin:12px 0 24px}
    header img{height:56px;width:56px;object-fit:contain;border-radius:12px;background:#0b2f44;border:1px solid #11364a}
    header h1{font-size:clamp(22px,4vw,32px);margin:0;letter-spacing:0.3px}
    header .badge{margin-left:auto;padding:6px 10px;border:1px solid #1f3a4a;border-radius:999px;font-size:12px;background:#0b2130}

    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));
      border:1px solid rgba(148,163,184,0.15);border-radius:16px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,0.25)}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .col-6{grid-column:span 6}
    .col-12{grid-column:span 12}
    @media (max-width:900px){.col-6{grid-column:span 12}}

    .btn{appearance:none;border:none;border-radius:12px;padding:10px 14px;font-weight:600;color:#03121b;background:var(--accent);cursor:pointer}
    .btn.secondary{background:#0b2230;color:var(--text);border:1px solid #1a3240}
    .btn.ghost{background:transparent;color:var(--text);border:1px dashed #244552}
    .btn:disabled{opacity:.6;cursor:not-allowed}

    .choices{display:flex;flex-wrap:wrap;gap:12px}
    .choice{flex:1 1 220px;min-height:120px;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:16px;border-radius:16px;border:1px solid #1f3a4a;background:linear-gradient(180deg,#061a25,#07121a)}
    .choice h3{margin:0 0 8px;font-size:18px}
    .choice p{margin:0;color:#cbd5e1;font-size:14px;opacity:.9}

    label{display:block;margin:12px 0 6px;font-weight:600}
    input,select,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2b3f4a;background:#0a1821;color:var(--text)}
    .row{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .row > *[data-col="6"]{grid-column:span 6}
    .row > *[data-col="4"]{grid-column:span 4}
    .row > *[data-col="3"]{grid-column:span 3}
    .row > *[data-col="2"]{grid-column:span 2}
    @media (max-width:900px){.row > *{grid-column:span 12 !important}}

    .muted{color:#94a3b8;font-size:13px}
    .total{font-size:28px;font-weight:800}
    .tag{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;border:1px solid #1e3a4a;background:#0b2230;color:#9ed9ff;font-size:12px}
    .hr{height:1px;background:linear-gradient(90deg,transparent,#1d3a4a,transparent);margin:16px 0}

    /* Certificate preview */
    .certificate{
      background:white;color:#0b2130;border-radius:12px;padding:28px;border:1px solid #e2e8f0;
    }
    .certificate header{display:flex;gap:14px;align-items:center}
    .certificate header img{height:54px;width:54px;border-radius:10px;border:1px solid #d1e0e8;background:#eef7fb}
    .certificate h2{margin:4px 0 0;font-size:20px}
    .cert-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:10px}
    .cert-field{padding:10px;border:1px solid #e2e8f0;border-radius:10px;background:#fff}
    .cert-label{font-size:12px;color:#64748b;margin-bottom:4px}
    .cert-value{font-weight:600}
    .cert-footer{display:flex;justify-content:space-between;align-items:flex-end;margin-top:18px}
    .signature{margin-top:34px;border-top:1px solid #e2e8f0;padding-top:6px;font-size:12px;color:#64748b}

    /* Login gate */
    #gate{position:fixed;inset:0;background:radial-gradient(1200px 700px at 70% -10%,rgba(56,189,248,.12),transparent 60%),
      linear-gradient(135deg,#06131b,#02080c);display:flex;align-items:center;justify-content:center;}
    .gate-card{width:min(520px,92vw);}

    /* Print styles for certificate */
    @media print {
      body{background:white}
      #gate, header, #home, #calc, #cert form, .no-print{display:none !important}
      .certificate{border:none;box-shadow:none}
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
  <!-- √âcran mot de passe -->
  <div id="gate">
    <div class="wrap gate-card">
      <div class="card">
        <header>
          <img src="https://i.ibb.co/LzwcCLfN/logo-omc-nord.png" alt="OMC" />
          <h1>Ocean Medical Center ‚Äî Intranet</h1>
          <span class="badge">Acc√®s r√©serv√©</span>
        </header>
        <p class="muted">Cet espace est r√©serv√© aux membres de l'OMC. Merci d'entrer le mot de passe interne.</p>
        <label for="pwd">Mot de passe</label>
        <input id="pwd" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
        <div style="display:flex;gap:10px;margin-top:12px">
          <button class="btn" id="loginBtn">Entrer</button>
          <button class="btn ghost" id="rememberToggle" title="Se souvenir sur cet appareil">Se souvenir</button>
        </div>
        <p class="muted" style="margin-top:10px">Astuce : vous pouvez changer le mot de passe dans le code (const <strong>OMC_PASSWORD</strong>).</p>
      </div>
    </div>
  </div>

  <div class="wrap">
    <header class="no-print">
      <img src="https://i.ibb.co/LzwcCLfN/logo-omc-nord.png" alt="OMC" />
      <h1>Ocean Medical Center ‚Äî Intranet</h1>
      <span class="badge" id="who">Connect√©</span>
    </header>

    <!-- PAGE D‚ÄôACCUEIL -->
    <section id="home" class="card no-print">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:8px">
        <div>
          <div class="tag">üõ°Ô∏è Portail Interne</div>
          <h2 style="margin:6px 0 0">Bienvenue</h2>
          <p class="muted">Choisissez un module ci-dessous. Tout est calcul√© en local, rien n'est envoy√©.</p>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn secondary" id="logout">Se d√©connecter</button>
        </div>
      </div>
      <div class="choices">
        <div class="choice" data-open="calc">
          <div>
            <h3>Calcul des co√ªts d'intervention</h3>
            <p>Bar√®me, d√©placements, consommables, √©quipe In/Out‚Ä¶</p>
          </div>
          <button class="btn">Ouvrir</button>
        </div>
        <div class="choice" data-open="cert">
          <div>
            <h3>R√©aliser un certificat</h3>
            <p>Certificat m√©dical simple, embauche, aptitude port d'arme (RP).</p>
          </div>
          <button class="btn">Ouvrir</button>
        </div>
      </div>
    </section>

    <!-- MODULE CALCUL -->
    <section id="calc" class="card" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
        <h2 style="margin:0">üßÆ Calcul des co√ªts d'intervention</h2>
        <button class="btn secondary" data-back>‚Üê Retour</button>
      </div>
      <div class="hr"></div>
      <!-- Formulaire de calcul -->
      ...
    </section>

    <!-- MODULE CERTIFICAT -->
    <section id="cert" class="card" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
        <h2 style="margin:0">üìù G√©n√©rateur de certificat</h2>
        <div style="display:flex;gap:8px">
          <button class="btn secondary" data-back>‚Üê Retour</button>
          <button class="btn" id="sendDiscord">Envoyer vers Discord</button>
          <button class="btn" id="printCert">Imprimer / PDF</button>
        </div>
      </div>
      <div class="hr"></div>
      <!-- Formulaire + pr√©visualisation -->
      ...
    </section>
  </div>

  <script>
    // ======== Login gate ========
    const OMC_PASSWORD = "omc2025";
    const gate = document.getElementById('gate');
    const loginBtn = document.getElementById('loginBtn');
    const rememberBtn = document.getElementById('rememberToggle');
    const pwdInput = document.getElementById('pwd');
    const rememberKey = 'omc_remember_me';
    const tokenKey = 'omc_session_token';

    function setLoggedIn(){ gate.style.display='none'; }
    function setLoggedOut(){ gate.style.display='flex'; localStorage.removeItem(tokenKey); }

    // Autologin
    try{
      const saved = localStorage.getItem(tokenKey);
      if(saved === btoa(OMC_PASSWORD)) setLoggedIn();
    }catch(e){}

    loginBtn.addEventListener('click', ()=>{
      if(pwdInput.value !== OMC_PASSWORD){ alert('Mot de passe incorrect'); return; }
      if(localStorage.getItem(rememberKey)==='1'){
        localStorage.setItem(tokenKey, btoa(OMC_PASSWORD));
      }
      setLoggedIn();
    });

    // Entr√©e clavier
    pwdInput.addEventListener('keyup', (e)=>{ if(e.key==="Enter") loginBtn.click(); });

    rememberBtn.addEventListener('click', ()=>{
      const cur = localStorage.getItem(rememberKey)==='1';
      localStorage.setItem(rememberKey, cur?'0':'1');
      rememberBtn.classList.toggle('secondary');
      rememberBtn.textContent = (cur? 'Se souvenir' : 'M√©moris√© ‚úÖ');
    });

    // ======== Navigation ========
    const home = document.getElementById('home');
    const calc = document.getElementById('calc');
    const cert = document.getElementById('cert');
    document.querySelectorAll('.choice').forEach(el=>{
      el.addEventListener('click',()=>{
        const panel = el.getAttribute('data-open');
        home.style.display='none';
        if(panel==='calc') calc.style.display='block';
        if(panel==='cert') cert.style.display='block';
      });
    });
    document.querySelectorAll('[data-back]').forEach(b=> b.addEventListener('click',()=>{
      calc.style.display='none'; cert.style.display='none'; home.style.display='block';
    }));
    document.getElementById('logout').addEventListener('click',()=> setLoggedOut());

    // (ici reste le code du calcul et du certificat inchang√©)

    // ======== Bouton Discord ========
    const sendBtn = document.getElementById('sendDiscord');
    if(sendBtn){ sendBtn.addEventListener('click', sendToDiscord); }
  </script>
</body>
</html>
